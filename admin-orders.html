<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MzansiBuy Admin Orders</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

<header class="top">
  <h1>MzansiBuy - Orders</h1>
</header>

<!-- Password Section -->
<div id="passwordSection" class="center">
  <h2>Enter Admin Password</h2>
  <input type="password" id="adminPassword" placeholder="Password">
  <button id="loginBtn">Login</button>
  <p id="passwordError" style="color:red;"></p>
</div>

<!-- Orders Section -->
<div id="ordersSection" class="hidden">
  <h2>All Orders</h2>
  <table id="ordersTable">
    <thead>
      <tr>
        <th>Customer Name</th>
        <th>Product</th>
        <th>Price (R)</th>
        <th>Payment</th>
        <th>Time</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="ordersBody"></tbody>
  </table>
</div>

<script type="module">
  const adminPassword = "admin123"; // password
  const loginBtn = document.getElementById("loginBtn");
  const passwordInput = document.getElementById("adminPassword");
  const passwordError = document.getElementById("passwordError");
  const passwordSection = document.getElementById("passwordSection");
  const ordersSection = document.getElementById("ordersSection");
  const ordersBody = document.getElementById("ordersBody");

  // Check password
  loginBtn.onclick = () => {
    if(passwordInput.value === adminPassword){
      passwordSection.classList.add("hidden");
      ordersSection.classList.remove("hidden");
      displayOrders();
    } else {
      passwordError.textContent = "Incorrect password!";
    }
  };

  // Display orders from localStorage
  function displayOrders(){
    const orders = JSON.parse(localStorage.getItem("orders")) || [];
    ordersBody.innerHTML = "";

    orders.forEach((order, index) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${order.customerName}</td>
        <td>${order.productName}</td>
        <td>${Number(order.productPrice)}</td>
        <td>${order.payment}</td>
        <td>${new Date(order.timestamp).toLocaleString()}</td>
        <td>
          <button class="deleteBtn" data-index="${index}">
            <i class="fa-solid fa-trash"></i>
          </button>
        </td>
      `;
      ordersBody.appendChild(tr);
    });

    // Add delete functionality
    document.querySelectorAll(".deleteBtn").forEach(btn => {
      btn.onclick = () => {
        const idx = btn.dataset.index;
        orders.splice(idx, 1);
        localStorage.setItem("orders", JSON.stringify(orders));
        displayOrders();
      };
    });
  }
</script>
</body>
</html>